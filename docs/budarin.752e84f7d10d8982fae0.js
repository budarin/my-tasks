(self.webpackChunkmy_tasks=self.webpackChunkmy_tasks||[]).push([[872],{224:function(t,n,e){e.d(n,{_:function(){return s}});var r=e(2647),i=e(2064);const o=()=>{};class s{endpoint;pinoInstance;constructor(t,n,e){if(void 0===n&&(n=void 0),void 0===e&&(e=void 0),this.endpoint=t,e)this.pinoInstance=e;else{const e=(0,i.pino)({formatters:{level:t=>({level:t.toUpperCase()})},browser:{serialize:!1,asObject:!1,transmit:{send:async(n,e)=>{const o=i.pino.levels.values[this.pinoInstance.level];i.pino.levels.values[n]>=o&&await fetch(`${t}/${n}`,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({id:(0,r.e)(),method:n,params:e})})}},write:o}});this.pinoInstance=n?e.child(n):e}}info(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];this.pinoInstance.info(n)}warn(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];this.pinoInstance.warn(n)}error(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];this.pinoInstance.error(n)}debug(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];this.pinoInstance.debug(n)}child(t){const n=this.pinoInstance.child(t);return new s(this.endpoint,t,n)}}},5452:function(t,n,e){e.d(n,{u:function(){return i}});const r={debug:()=>{}};class i{storeName;logger;constructor(t,n){void 0===n&&(n=r),this.storeName=t,this.logger=n}async setItem(t,n){const e=await globalThis.caches.open(this.storeName),r=new Response(JSON.stringify(n),{headers:{"Content-Type":"application/json; charset=utf-8"}});await e.put(t,r)}async getItem(t){const n=await globalThis.caches.open(this.storeName),e=await n.match(t);return e?e.json():{}}async removeItem(t){const n=await globalThis.caches.open(this.storeName);return await n.delete(t)}async clear(t){return await globalThis.caches.delete(t)}}},9464:function(t,n,e){function r(t,n){if(t===n)return!0;if("object"!=typeof t||null===t||"object"!=typeof n||null===n)return!1;const e=Object.keys(t),i=Object.keys(n);return e.length===i.length&&e.every((e=>i.includes(e)&&r(t[e],n[e])))}e.d(n,{I:function(){return r}})},9536:function(t,n,e){e.d(n,{Oo:function(){return i}});const r="application/json; charset=utf-8",i=t=>async n=>{const e=n.body.id;try{const i=await fetch(`${t}/${n.body.method}`,{...n,method:"POST",body:JSON.stringify(n.body),headers:{...n?.headers,"x-request-id":String(e),"content-type":r,accept:r}});if(!1===i.ok)return{id:e,error:{code:i.status,message:i.statusText}};const o=await i.json();if(!function(t){if(function(t){return"id"in t&&"result"in t&&!("error"in t)}(t))return!0;if(function(t){return"id"in t&&"error"in t&&!("result"in t)}(t)){const{error:n}=t;return!("number"!=typeof n.code||"string"!=typeof n.message||"data"in n&&"object"!=typeof n.data||"stack"in n&&"string"!=typeof n.stack)}return!1}(o))throw new Error("Структура данных в ответе сервера не соответствует формату JSON-RPC");return o}catch(t){return{id:e,error:{code:-1,message:t.message,stack:t.stack}}}}},8368:function(t,n,e){e.d(n,{I:function(){return i}});const r={debug:()=>{}};class i{logger;constructor(t){void 0===t&&(t=r),this.logger=t}setItem(t,n){localStorage.setItem(t,encodeURIComponent(JSON.stringify(n)))}getItem(t){return JSON.parse(decodeURIComponent(localStorage.getItem(t)))}removeItem(t){localStorage.removeItem(t)}clear(){localStorage.clear()}}},8219:function(t,n,e){e.d(n,{k:function(){return i}});const r=()=>{},i=new Proxy({},{get:()=>r})},216:function(t,n,e){e.d(n,{s:function(){return r}});const r=t=>{const n=()=>{throw new Error(t||"Попытка обратиться к неинициализированному сервису.")};return new Proxy((()=>{}),{get:n,apply:n})}},3120:function(t,n,e){function r(t){const{category_id:n,icon_id:e,category_name:r}=t||{};return{category_id:n,icon_id:e,category_name:r}}e.d(n,{IZ:function(){return l}});var i=e(9812),o=e(3184),s=e(3163),c=e(4476),u=e(2108);const a="Категория",d={icon_id:{validators:[[i.m,(0,o.K)(a,"icon_id")]],required:!0},category_name:{validators:[[(0,s.S)(3,20),(0,c.k)(a,"category_name",3,20)]],required:!0}},f={category_id:{validators:[[i.m,(0,o.K)(a,"category_id")]],required:!0},...d},l=t=>(0,u.w)(t,f,r,a)},5480:function(t,n,e){e.d(n,{cp:function(){return r.cp}});var r=e(7708)},7708:function(t,n,e){function r(t){return n=>void 0===n||t(n)}function i(t){return"boolean"==typeof t}function o(t,n){return`Свойство сущности ${t} "${n}" должно быть undefined или boolean`}function s(t){const{task_id:n,title:e,priority_id:r,category_id:i,description:o,expire_date_time:s,deleted:c,completed:u}=t||{};return{task_id:n,title:e,priority_id:r,category_id:i,description:o,expire_date_time:s,deleted:c,completed:u}}e.d(n,{cp:function(){return s},Qj:function(){return p}});var c=e(3163),u=e(4476),a=e(9812),d=e(3184),f=e(2108);const l="Задача",y={title:{validators:[[(0,c.S)(3,100),(0,u.k)(l,"title",3,100)]],required:!0},priority_id:{validators:[[a.m,(0,d.K)(l,"priority_id")]],required:!0},category_id:{validators:[[r(a.m),function(t,n){return`Свойство сущности ${t} "${n}" должно быть undefined или целым числом`}(l,"category_id")]]},description:{validators:[[r((0,c.S)(3,1e3)),(0,u.k)(l,"description",3,1e3)]]},expire_date_time:{validators:[[r((function(t){return/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?Z$/.test(t)})),`Свойство сущности ${l} "expire_date_time" должно быть датой в формате ISO`]]},deleted:{validators:[[r(i),o(l,"deleted")]]},completed:{validators:[[r(i),o(l,"completed")]]}},g={task_id:{validators:[[a.m,(0,d.K)(l,"task_id")]],required:!0},...y},p=t=>(0,f.w)(t,g,s,l)},6735:function(t,n,e){function r(t,n){return function(e){const r=t(e);return r.error?(i.QE.error(r.error.message,r.error.data),r):n(e)}}e.d(n,{Y:function(){return r}});var i=e(3344)},3760:function(t,n,e){function r(t,n){return i.QE.error(n,t),{error:{message:n,data:t}}}e.d(n,{G:function(){return r}});var i=e(3344)},8824:function(t,n,e){e.d(n,{G:function(){return a}});var r=e(3344),i=e(3760),o=e(3120),s=e(2232),c=e(6735),u=e(9448);const a=(0,c.Y)(o.IZ,(function(t){const n=r.is.getState();if(function(t,n){return Boolean(t.categories.byId[n.category_id])}(n,t))return(0,i.G)(t,"Добавление дубликата категории");if((0,u.s)(n,t))return(0,i.G)(t,"Добавление категории с уже существующим именем категории");if((0,s.u)(n,t))return(0,i.G)(t,"Добавление категории с не существующей иконкой");const e=function(t,n){const{category_id:e}=n;return{...t,categories:{...t.categories,ids:[...t.categories.ids,e],byId:{...t.categories.byId,[e]:n}}}}(n,t);return e!==n&&r.is.setState(e),{result:t}}))},4788:function(t,n,e){e.d(n,{C:function(){return c}});var r=e(3344),i=e(3760),o=e(3120),s=e(4060);const c=(0,e(6735).Y)(o.IZ,(function(t){const n=r.is.getState();if(function(t,n){return Boolean(void 0===t.categories.byId[n.category_id])||!(0,s.k)(t.categories.byId[n.category_id],n)}(n,t))return(0,i.G)(t,"Категория не найдена");if(function(t,n){return Boolean(Object.values(t.tasks.byId).find((t=>t.category_id===n.category_id)))}(n,t))return(0,i.G)(t,"Удаление категории, которая используется");const e=function(t,n){const{category_id:e}=n,{[e]:r,...i}=t.categories.byId;return{...t,categories:{...t.categories,ids:t.categories.ids.filter((t=>t!==e)),byId:{...i}}}}(n,t);return e!==n&&r.is.setState(e),{result:t}}))},9448:function(t,n,e){function r(t,n){for(const e in t.categories.byId)if(t.categories.byId[e].category_name===n.category_name&&Number(e)!==n.category_id)return!0;return!1}e.d(n,{s:function(){return r}})},2232:function(t,n,e){function r(t,n){return Boolean(void 0===t.icons.byId[n.icon_id])}e.d(n,{u:function(){return r}})},3036:function(t,n,e){e.d(n,{g:function(){return d}});var r=e(4060),i=e(3344),o=e(3760),s=e(3120),c=e(6735),u=e(2232),a=e(9448);const d=(0,c.Y)(s.IZ,(function(t){const n=i.is.getState();if((0,r.k)(t,n.categories.byId[t.category_id]))return{result:t};if(function(t,n){return Boolean(void 0===t.categories.byId[n.category_id])}(n,t))return(0,o.G)(t,"Категория не найдена");if((0,u.u)(n,t))return(0,o.G)(t,"Модификация категории с не существующей иконкой");if((0,a.s)(n,t))return(0,o.G)(t,"Попытка изменить имя категории на имя уже существующей категории");const e=function(t,n){const{category_id:e}=n;return{...t,categories:{...t.categories,byId:{...t.categories.byId,[e]:n}}}}(n,t);return e!==n&&i.is.setState(e),{result:t}}))},7992:function(t,n,e){function r(t){const{icon_id:n,file_name:e}=t||{};return{icon_id:n,file_name:e}}e.d(n,{S:function(){return y}});var i=e(3344),o=e(9812),s=e(3184),c=e(3163),u=e(4476),a=e(2108);const d="Иконка",f={icon_id:{validators:[[o.m,(0,s.K)(d,"icon_id")]],required:!0},file_name:{validators:[[(0,c.S)(3,20),(0,u.k)(d,"fole_name",3,20)]],required:!0}};var l=e(3760);const y=(0,e(6735).Y)((t=>(0,a.w)(t,f,r,d)),(function(t){const n=i.is.getState();if(function(t,n){return Boolean(t.icons.ids.indexOf(n.icon_id)>-1)}(n,t))return(0,l.G)(t,"Добавление дубликата идентификатора иконки");if(function(t,n){for(const e in t.icons.byId)if(t.icons.byId[e].file_name===n.file_name)return!0;return!1}(n,t))return(0,l.G)(t,"Добавление иконки с уже существующим именем файла иконки");const e=function(t,n){const{icon_id:e}=n;return{...t,icons:{...t.icons,ids:[...t.icons.ids,e],byId:{...t.icons.byId,[e]:n}}}}(n,t);return e!==n&&i.is.setState(e),{result:t}}))},3344:function(t,n,e){function r(t,n){s=t,c=n}e.d(n,{QE:function(){return c},is:function(){return s},wP:function(){return o},y8:function(){return r}});var i=e(216);const o={icons:{byId:{},ids:[]},priorities:{byId:{},ids:[]},categories:{byId:{},ids:[]},tasks:{byId:{},ids:[]}};let s=(0,i.s)("Попытка использовать TasksStore до его инициализации!"),c=(0,i.s)("Попытка использовать logger в TasksStore до его инициализации!")},4824:function(t,n,e){function r(t){const{priority_id:n,priority_name:e}=t||{};return{priority_id:n,priority_name:e}}e.d(n,{u:function(){return l}});var i=e(3344),o=e(3760),s=e(9812),c=e(3184),u=e(2108);const a=["низкий","нормальный","повышенный","высокий"],d="Приоритет",f={priority_id:{validators:[[s.m,(0,c.K)(d,"priority_id")]],required:!0},priority_name:{validators:[[t=>a.includes(t),`Свойство сущности ${d} "priority_name" должно быть одним из ${JSON.stringify(a)}`]],required:!0}};const l=(0,e(6735).Y)((t=>(0,u.w)(t,f,r,d)),(function(t){const n=i.is.getState();if(function(t,n){return Boolean(t.priorities.ids.indexOf(n.priority_id)>-1)}(n,t))return(0,o.G)(t,"Добавление дубликата приоритета");if(function(t,n){for(const e in t.priorities.byId)if(t.priorities.byId[e].priority_name===n.priority_name)return!0;return!1}(n,t))return(0,o.G)(t,"Добавление приоритета с уже существующим именем");const e=function(t,n){const{priority_id:e}=n;return{...t,priorities:{...t.priorities,ids:[...t.priorities.ids,e],byId:{...t.priorities.byId,[e]:n}}}}(n,t);return e!==n&&i.is.setState(e),{result:t}}))},3320:function(t,n,e){e.d(n,{_:function(){return a}});var r=e(3344),i=e(7708),o=e(3760),s=e(8848),c=e(5604),u=e(4328);const a=(0,e(6735).Y)(i.Qj,(function(t){const n=r.is.getState();if(function(t,n){return Boolean(t.tasks.byId[n.task_id])}(n,t))return(0,o.G)(t,"Добавление дубликата задачи");if((0,s.G)(n,t))return(0,o.G)(t,"Добавление задачи с не существующим приоритетом");if((0,c.Q)(n,t))return(0,o.G)(t,"Добавление задачи с не существующей категорией");const e=function(t,n){const{tasks:e}=t,{task_id:r}=n,i=(0,u.i)(n);return{...t,tasks:{...e,ids:[...e.ids,r],byId:{...e.byId,[r]:i}}}}(n,t);return e!==n&&r.is.setState(e),{result:t}}))},6456:function(t,n,e){e.d(n,{e:function(){return c}});var r=e(3344),i=e(7708),o=e(3760),s=e(4060);const c=(0,e(6735).Y)(i.Qj,(function(t){const n=r.is.getState();if(function(t,n){return void 0===t.tasks.byId[n.task_id]||!(0,s.k)(t.tasks.byId[n.task_id],n)}(n,t))return(0,o.G)(t,"Задача не найдена");const e=function(t,n){const{tasks:e}=t,{task_id:r}=n,i=e.ids.filter((t=>t!==r)),{[r]:o,...s}=e.byId;return{...t,tasks:{...e,ids:[...i],byId:{...s}}}}(n,t);return e!==n&&r.is.setState(e),{result:t}}))},4328:function(t,n,e){function r(t){const{task_id:n,title:e,priority_id:r,category_id:i,description:o,expire_date_time:s,deleted:c,completed:u}=t;if(s){const n=Date.parse(s),e=new Date(n);e.setHours(0,0,0,0);const r=e.getTime();return{...t,expire_date_time:s,expire_date_ts:r,expire_date_time_ts:n}}return{task_id:n,title:e,priority_id:r,category_id:i,description:o,deleted:c,completed:u,expire_date_time:void 0,expire_date_ts:void 0,expire_date_time_ts:void 0}}e.d(n,{i:function(){return r}})},5604:function(t,n,e){function r(t,n){return Boolean(void 0!==n.category_id&&void 0===t.categories.byId[n.category_id])}e.d(n,{Q:function(){return r}})},8848:function(t,n,e){function r(t,n){return Boolean(void 0===t.priorities.byId[n.priority_id])}e.d(n,{G:function(){return r}})},264:function(t,n,e){e.d(n,{a:function(){return d}});var r=e(3344),i=e(7708),o=e(3760),s=e(8848),c=e(5604),u=e(6735),a=e(4328);const d=(0,u.Y)(i.Qj,(function(t){const n=r.is.getState();if(function(t,n){return void 0===t.tasks.byId[n.task_id]}(n,t))return(0,o.G)(t,"Задача не найдена");if((0,s.G)(n,t))return(0,o.G)(t,"Обновление задачи с не существующим приоритетом");if((0,c.Q)(n,t))return(0,o.G)(t,"Обновление задачи с не существующей категорией");const e=function(t,n){const{tasks:e}=t,{task_id:r}=n;return{...t,tasks:{...e,byId:{...e.byId,[r]:(0,a.i)(n)}}}}(n,t);return e!==n&&r.is.setState(e),{result:t}}))},2647:function(t,n,e){function r(t){void 0===t&&(t=Date.now());const n=new Uint8Array(10);!function(t){if(void 0!==globalThis.crypto&&"function"==typeof globalThis.crypto.getRandomValues)return globalThis.crypto.getRandomValues(t);if("function"==typeof require){const n=require("crypto").randomBytes(t.length);return t.set(n),t}throw new Error("Secure random number generation is not supported in this environment.")}(n);const e=t.toString(16).padStart(12,"0"),r=function(t){let n="";for(let e=0;e<t.length;e++){const r=t[e].toString(16);n+=2===r.length?r:"0"+r}return n}(n);return`${e.substring(0,8)}-${e.substring(8)}-${r.substring(0,4)}-${r.substring(4,8)}-${r.substring(8)}`}e.d(n,{e:function(){return r}})},9812:function(t,n,e){function r(t){return"number"==typeof t&&Number.isInteger(t)}e.d(n,{m:function(){return r}})},376:function(t,n,e){function r(t){return"string"==typeof t}e.d(n,{c:function(){return r}})},6136:function(t,n,e){function r(t){return n=>t.includes(n)}e.d(n,{G:function(){return r}})},3163:function(t,n,e){function r(t,n){return void 0===n&&(n=65536),e=>"string"==typeof e&&e.length>=t&&e.length<=n}e.d(n,{S:function(){return r}})},3184:function(t,n,e){e.d(n,{K:function(){return r}});const r=(t,n)=>`Свойство сущности ${t} "${n}" должно быть целым числом`},3972:function(t,n,e){function r(t,n){return`Свойство сущности ${t} "${n}" должно быть значением из списка`}e.d(n,{a:function(){return r}})},6808:function(t,n,e){function r(t,n){return`Свойство сущности ${t} "${n}" должно быть строкой`}e.d(n,{I:function(){return r}})},4476:function(t,n,e){e.d(n,{k:function(){return r}});const r=(t,n,e,r)=>`Свойство сущности ${t} "${n}" должно быть строкой длиной от ${e} до ${r} символов`},2108:function(t,n,e){e.d(n,{w:function(){return r}});const r=(t,n,e,r)=>{if(!1===function(t){return"object"==typeof t&&null!==t}(t))return{error:{message:`Сущность "${r}" должна быть объектом`,data:t}};const i=t,o=Object.keys(n);for(let e=0;e<o.length;e++){const s=o[e],c=n[s];if(!0===c.required&&void 0===i[s])return{error:{message:`Свойство "${s}" сущности ${r} отсутствует`,data:t}};for(let n=0;n<c.validators.length;n++){const e=c.validators[n];if(!1===e[0](i[s]))return{error:{message:e[1],data:t}}}}return{result:e(i)}}}}]);