(self.webpackChunkmy_tasks=self.webpackChunkmy_tasks||[]).push([[12],{6565:function(t,n,e){function r(t){void 0===t&&(t=Date.now());const n=new Uint8Array(10);!function(t){if(void 0!==globalThis.crypto&&"function"==typeof globalThis.crypto.getRandomValues)return globalThis.crypto.getRandomValues(t);if("function"==typeof require){const n=require("crypto").randomBytes(t.length);return t.set(n),t}throw new Error("Secure random number generation is not supported in this environment.")}(n);const e=t.toString(16).padStart(12,"0"),r=function(t){let n="";for(let e=0;e<t.length;e++){const r=t[e].toString(16);n+=2===r.length?r:"0"+r}return n}(n);return`${e.substring(0,8)}-${e.substring(8)}-${r.substring(0,4)}-${r.substring(4,8)}-${r.substring(8)}`}e.d(n,{X:function(){return s}});var i=e(4874);const o=()=>{};class s{endpoint;pinoInstance;constructor(t,n,e){if(void 0===n&&(n=void 0),void 0===e&&(e=void 0),this.endpoint=t,e)this.pinoInstance=e;else{const e=(0,i.pino)({formatters:{level:t=>({level:t.toUpperCase()})},browser:{serialize:!1,asObject:!1,transmit:{send:async(n,e)=>{const o=i.pino.levels.values[this.pinoInstance.level];i.pino.levels.values[n]>=o&&await fetch(`${t}/${n}`,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({id:r(),method:n,params:e})})}},write:o}});this.pinoInstance=n?e.child(n):e}}info(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];this.pinoInstance.info(n)}warn(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];this.pinoInstance.warn(n)}error(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];this.pinoInstance.error(n)}debug(){for(var t=arguments.length,n=new Array(t),e=0;e<t;e++)n[e]=arguments[e];this.pinoInstance.debug(n)}child(t){const n=this.pinoInstance.child(t);return new s(this.endpoint,t,n)}}},9324:function(t,n,e){e.d(n,{E:function(){return i}});const r={debug:()=>{}};class i{storeName;logger;constructor(t,n){void 0===n&&(n=r),this.storeName=t,this.logger=n}async setItem(t,n){const e=await globalThis.caches.open(this.storeName),r=new Response(JSON.stringify(n),{headers:{"Content-Type":"application/json; charset=utf-8"}});await e.put(t,r)}async getItem(t){const n=await globalThis.caches.open(this.storeName),e=await n.match(t);if(e){return await e.json()}return{}}async removeItem(t){const n=await globalThis.caches.open(this.storeName);return await n.delete(t)}async clear(t){return await globalThis.caches.delete(t)}}},2677:function(t,n,e){function r(t,n){if(t===n)return!0;if("object"!=typeof t||null===t||"object"!=typeof n||null===n)return!1;const e=Object.keys(t),i=Object.keys(n);return e.length===i.length&&e.every((e=>i.includes(e)&&r(t[e],n[e])))}e.d(n,{b:function(){return r}})},1232:function(t,n,e){e.d(n,{WL:function(){return i}});const r="application/json; charset=utf-8",i=t=>async n=>{const e=n.body.id;try{const i=await fetch(`${t}/${n.body.method}`,{...n,method:"POST",body:JSON.stringify(n.body),headers:{...n?.headers,"x-request-id":String(e),"content-type":r,accept:r}});if(!1===i.ok)return{id:e,error:{code:i.status,message:i.statusText}};const o=await i.json();if(!function(t){if(function(t){return"id"in t&&"result"in t&&!("error"in t)}(t))return!0;if(function(t){return"id"in t&&"error"in t&&!("result"in t)}(t)){const{error:n}=t;return!("number"!=typeof n.code||"string"!=typeof n.message||"data"in n&&"object"!=typeof n.data||"stack"in n&&"string"!=typeof n.stack)}return!1}(o))throw new Error("Структура данных в ответе сервера не соответствует формату JSON-RPC");return o}catch(t){return{id:e,error:{code:-1,message:t.message,stack:t.stack}}}}},9755:function(t,n,e){e.d(n,{V:function(){return i}});const r={debug:()=>{}};class i{logger;constructor(t){void 0===t&&(t=r),this.logger=t}setItem(t,n){localStorage.setItem(t,encodeURIComponent(JSON.stringify(n)))}getItem(t){return JSON.parse(decodeURIComponent(localStorage.getItem(t)))}removeItem(t){localStorage.removeItem(t)}clear(){localStorage.clear()}}},3788:function(t,n,e){const r=()=>{};new Proxy({},{get:()=>r})},7270:function(t,n,e){e.d(n,{o:function(){return r}});const r=t=>{const n=()=>{throw new Error(t||"Попытка обратиться к неинициализированному сервису.")};return new Proxy((()=>{}),{get:n,apply:n})}},4460:function(t,n,e){function r(t){const{category_id:n,icon_id:e,category_name:r}=t||{};return{category_id:n,icon_id:e,category_name:r}}e.d(n,{zo:function(){return l}});var i=e(4303),o=e(140),s=e(6412),c=e(9977),u=e(8708);const a="Категория",d={icon_id:{validators:[[i.F,(0,o.a)(a,"icon_id")]],required:!0},category_name:{validators:[[(0,s.y)(3,20),(0,c.P)(a,"category_name",3,20)]],required:!0}},f={category_id:{validators:[[i.F,(0,o.a)(a,"category_id")]],required:!0},...d},l=t=>(0,u.U)(t,f,r,a)},1727:function(t,n,e){e.d(n,{gg:function(){return r.gg}});var r=e(7730)},7730:function(t,n,e){function r(t){return n=>void 0===n||t(n)}function i(t){return"boolean"==typeof t}function o(t,n){return`Свойство сущности ${t} "${n}" должно быть undefined или boolean`}function s(t){const{task_id:n,title:e,priority_id:r,category_id:i,description:o,expire_date_time:s,deleted:c,completed:u}=t||{};return{task_id:n,title:e,priority_id:r,category_id:i,description:o,expire_date_time:s,deleted:c,completed:u}}e.d(n,{gg:function(){return s},iX:function(){return p}});var c=e(6412),u=e(9977),a=e(4303),d=e(140),f=e(8708);const l="Задача",g={title:{validators:[[(0,c.y)(3,100),(0,u.P)(l,"title",3,100)]],required:!0},priority_id:{validators:[[a.F,(0,d.a)(l,"priority_id")]],required:!0},category_id:{validators:[[r(a.F),function(t,n){return`Свойство сущности ${t} "${n}" должно быть undefined или целым числом`}(l,"category_id")]]},description:{validators:[[r((0,c.y)(3,1e3)),(0,u.P)(l,"description",3,1e3)]]},expire_date_time:{validators:[[r((function(t){return/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?Z$/.test(t)})),`Свойство сущности ${l} "expire_date_time" должно быть датой в формате ISO`]]},deleted:{validators:[[r(i),o(l,"deleted")]]},completed:{validators:[[r(i),o(l,"completed")]]}},y={task_id:{validators:[[a.F,(0,d.a)(l,"task_id")]],required:!0},...g},p=t=>(0,f.U)(t,y,s,l)},6624:function(t,n,e){function r(t,n){return function(e){const r=t(e);return r.error?(i.vF.error(r.error.message,r.error.data),r):n(e)}}e.d(n,{R:function(){return r}});var i=e(6169)},5896:function(t,n,e){function r(t,n){return i.vF.error(n,t),{error:{message:n,data:t}}}e.d(n,{H:function(){return r}});var i=e(6169)},3702:function(t,n,e){e.d(n,{A:function(){return a}});var r=e(6169),i=e(5896),o=e(4460),s=e(924),c=e(6624),u=e(1188);const a=(0,c.R)(o.zo,(function(t){const n=r.M_.getState();if(function(t,n){return Boolean(t.categories.byId[n.category_id])}(n,t))return(0,i.H)(t,"Добавление дубликата категории");if((0,u.h)(n,t))return(0,i.H)(t,"Добавление категории с уже существующим именем категории");if((0,s.$)(n,t))return(0,i.H)(t,"Добавление категории с не существующей иконкой");const e=function(t,n){const{category_id:e}=n;return{...t,categories:{...t.categories,ids:[...t.categories.ids,e],byId:{...t.categories.byId,[e]:n}}}}(n,t);return e!==n&&r.M_.setState(e),{result:t}}))},4230:function(t,n,e){e.d(n,{K:function(){return c}});var r=e(6169),i=e(5896),o=e(4460),s=e(3402);const c=(0,e(6624).R)(o.zo,(function(t){const n=r.M_.getState();if(function(t,n){return Boolean(void 0===t.categories.byId[n.category_id])||!(0,s.x)(t.categories.byId[n.category_id],n)}(n,t))return(0,i.H)(t,"Категория не найдена");if(function(t,n){return Boolean(Object.values(t.tasks.byId).find((t=>t.category_id===n.category_id)))}(n,t))return(0,i.H)(t,"Удаление категории, которая используется");const e=function(t,n){const{category_id:e}=n,{[e]:r,...i}=t.categories.byId;return{...t,categories:{...t.categories,ids:t.categories.ids.filter((t=>t!==e)),byId:{...i}}}}(n,t);return e!==n&&r.M_.setState(e),{result:t}}))},1188:function(t,n,e){function r(t,n){for(const e in t.categories.byId)if(t.categories.byId[e].category_name===n.category_name&&Number(e)!==n.category_id)return!0;return!1}e.d(n,{h:function(){return r}})},924:function(t,n,e){function r(t,n){return Boolean(void 0===t.icons.byId[n.icon_id])}e.d(n,{$:function(){return r}})},2069:function(t,n,e){e.d(n,{s:function(){return d}});var r=e(3402),i=e(6169),o=e(5896),s=e(4460),c=e(6624),u=e(924),a=e(1188);const d=(0,c.R)(s.zo,(function(t){const n=i.M_.getState();if((0,r.x)(t,n.categories.byId[t.category_id]))return{result:t};if(function(t,n){return Boolean(void 0===t.categories.byId[n.category_id])}(n,t))return(0,o.H)(t,"Категория не найдена");if((0,u.$)(n,t))return(0,o.H)(t,"Модификация категории с не существующей иконкой");if((0,a.h)(n,t))return(0,o.H)(t,"Попытка изменить имя категории на имя уже существующей категории");const e=function(t,n){const{category_id:e}=n;return{...t,categories:{...t.categories,byId:{...t.categories.byId,[e]:n}}}}(n,t);return e!==n&&i.M_.setState(e),{result:t}}))},6539:function(t,n,e){function r(t){const{icon_id:n,file_name:e}=t||{};return{icon_id:n,file_name:e}}e.d(n,{X:function(){return g}});var i=e(6169),o=e(4303),s=e(140),c=e(6412),u=e(9977),a=e(8708);const d="Иконка",f={icon_id:{validators:[[o.F,(0,s.a)(d,"icon_id")]],required:!0},file_name:{validators:[[(0,c.y)(3,20),(0,u.P)(d,"fole_name",3,20)]],required:!0}};var l=e(5896);const g=(0,e(6624).R)((t=>(0,a.U)(t,f,r,d)),(function(t){const n=i.M_.getState();if(function(t,n){return Boolean(t.icons.ids.indexOf(n.icon_id)>-1)}(n,t))return(0,l.H)(t,"Добавление дубликата идентификатора иконки");if(function(t,n){for(const e in t.icons.byId)if(t.icons.byId[e].file_name===n.file_name)return!0;return!1}(n,t))return(0,l.H)(t,"Добавление иконки с уже существующим именем файла иконки");const e=function(t,n){const{icon_id:e}=n;return{...t,icons:{...t.icons,ids:[...t.icons.ids,e],byId:{...t.icons.byId,[e]:n}}}}(n,t);return e!==n&&i.M_.setState(e),{result:t}}))},6169:function(t,n,e){function r(t,n){s=t,c=n}e.d(n,{B5:function(){return o},M_:function(){return s},Uz:function(){return r},vF:function(){return c}});var i=e(7270);const o={icons:{byId:{},ids:[]},priorities:{byId:{},ids:[]},categories:{byId:{},ids:[]},tasks:{byId:{},ids:[]}};let s=(0,i.o)("Попытка использовать TasksStore до его инициализации!"),c=(0,i.o)("Попытка использовать logger в TasksStore до его инициализации!")},4248:function(t,n,e){function r(t){const{priority_id:n,priority_name:e}=t||{};return{priority_id:n,priority_name:e}}e.d(n,{m:function(){return l}});var i=e(6169),o=e(5896),s=e(4303),c=e(140),u=e(8708);const a=["низкий","нормальный","повышенный","высокий"],d="Приоритет",f={priority_id:{validators:[[s.F,(0,c.a)(d,"priority_id")]],required:!0},priority_name:{validators:[[t=>a.includes(t),`Свойство сущности ${d} "priority_name" должно быть одним из ${JSON.stringify(a)}`]],required:!0}};const l=(0,e(6624).R)((t=>(0,u.U)(t,f,r,d)),(function(t){const n=i.M_.getState();if(function(t,n){return Boolean(t.priorities.ids.indexOf(n.priority_id)>-1)}(n,t))return(0,o.H)(t,"Добавление дубликата приоритета");if(function(t,n){for(const e in t.priorities.byId)if(t.priorities.byId[e].priority_name===n.priority_name)return!0;return!1}(n,t))return(0,o.H)(t,"Добавление приоритета с уже существующим именем");const e=function(t,n){const{priority_id:e}=n;return{...t,priorities:{...t.priorities,ids:[...t.priorities.ids,e],byId:{...t.priorities.byId,[e]:n}}}}(n,t);return e!==n&&i.M_.setState(e),{result:t}}))},8787:function(t,n,e){e.d(n,{X:function(){return a}});var r=e(6169),i=e(7730),o=e(5896),s=e(1529),c=e(565),u=e(9756);const a=(0,e(6624).R)(i.iX,(function(t){const n=r.M_.getState();if(function(t,n){return Boolean(t.tasks.byId[n.task_id])}(n,t))return(0,o.H)(t,"Добавление дубликата задачи");if((0,s.S)(n,t))return(0,o.H)(t,"Добавление задачи с не существующим приоритетом");if((0,c.E)(n,t))return(0,o.H)(t,"Добавление задачи с не существующей категорией");const e=function(t,n){const{tasks:e}=t,{task_id:r}=n,i=(0,u.z)(n);return{...t,tasks:{...e,ids:[...e.ids,r],byId:{...e.byId,[r]:i}}}}(n,t);return e!==n&&r.M_.setState(e),{result:t}}))},143:function(t,n,e){e.d(n,{v:function(){return c}});var r=e(6169),i=e(7730),o=e(5896),s=e(3402);const c=(0,e(6624).R)(i.iX,(function(t){const n=r.M_.getState();if(function(t,n){return void 0===t.tasks.byId[n.task_id]||!(0,s.x)(t.tasks.byId[n.task_id],n)}(n,t))return(0,o.H)(t,"Задача не найдена");const e=function(t,n){const{tasks:e}=t,{task_id:r}=n,i=e.ids.filter((t=>t!==r)),{[r]:o,...s}=e.byId;return{...t,tasks:{...e,ids:[...i],byId:{...s}}}}(n,t);return e!==n&&r.M_.setState(e),{result:t}}))},9756:function(t,n,e){function r(t){const{task_id:n,title:e,priority_id:r,category_id:i,description:o,expire_date_time:s,deleted:c,completed:u}=t;if(s){const n=Date.parse(s),e=new Date(n);e.setHours(0,0,0,0);const r=e.getTime();return{...t,expire_date_time:s,expire_date_ts:r,expire_date_time_ts:n}}return{task_id:n,title:e,priority_id:r,category_id:i,description:o,deleted:c,completed:u,expire_date_time:void 0,expire_date_ts:void 0,expire_date_time_ts:void 0}}e.d(n,{z:function(){return r}})},565:function(t,n,e){function r(t,n){return Boolean(void 0!==n.category_id&&void 0===t.categories.byId[n.category_id])}e.d(n,{E:function(){return r}})},1529:function(t,n,e){function r(t,n){return Boolean(void 0===t.priorities.byId[n.priority_id])}e.d(n,{S:function(){return r}})},9046:function(t,n,e){e.d(n,{l:function(){return d}});var r=e(6169),i=e(7730),o=e(5896),s=e(1529),c=e(565),u=e(6624),a=e(9756);const d=(0,u.R)(i.iX,(function(t){const n=r.M_.getState();if(function(t,n){return void 0===t.tasks.byId[n.task_id]}(n,t))return(0,o.H)(t,"Задача не найдена");if((0,s.S)(n,t))return(0,o.H)(t,"Обновление задачи с не существующим приоритетом");if((0,c.E)(n,t))return(0,o.H)(t,"Обновление задачи с не существующей категорией");const e=function(t,n){const{tasks:e}=t,{task_id:r}=n;return{...t,tasks:{...e,byId:{...e.byId,[r]:(0,a.z)(n)}}}}(n,t);return e!==n&&r.M_.setState(e),{result:t}}))},2292:function(t,n,e){function r(t){void 0===t&&(t=Date.now());const n=new Uint8Array(10);!function(t){if(void 0!==globalThis.crypto&&"function"==typeof globalThis.crypto.getRandomValues)return globalThis.crypto.getRandomValues(t);if("function"==typeof require){const n=require("crypto").randomBytes(t.length);return t.set(n),t}throw new Error("Secure random number generation is not supported in this environment.")}(n);const e=t.toString(16).padStart(12,"0"),r=function(t){let n="";for(let e=0;e<t.length;e++){const r=t[e].toString(16);n+=2===r.length?r:"0"+r}return n}(n);return`${e.substring(0,8)}-${e.substring(8)}-${r.substring(0,4)}-${r.substring(4,8)}-${r.substring(8)}`}e.d(n,{Z:function(){return r}})},4303:function(t,n,e){function r(t){return"number"==typeof t&&Number.isInteger(t)}e.d(n,{F:function(){return r}})},3756:function(t,n,e){function r(t){return"string"==typeof t}e.d(n,{K:function(){return r}})},7128:function(t,n,e){function r(t){return n=>t.includes(n)}e.d(n,{Y:function(){return r}})},6412:function(t,n,e){function r(t,n){return void 0===n&&(n=65536),e=>"string"==typeof e&&e.length>=t&&e.length<=n}e.d(n,{y:function(){return r}})},140:function(t,n,e){e.d(n,{a:function(){return r}});const r=(t,n)=>`Свойство сущности ${t} "${n}" должно быть целым числом`},3640:function(t,n,e){function r(t,n){return`Свойство сущности ${t} "${n}" должно быть значением из списка`}e.d(n,{C:function(){return r}})},9068:function(t,n,e){function r(t,n){return`Свойство сущности ${t} "${n}" должно быть строкой`}e.d(n,{m:function(){return r}})},9977:function(t,n,e){e.d(n,{P:function(){return r}});const r=(t,n,e,r)=>`Свойство сущности ${t} "${n}" должно быть строкой длиной от ${e} до ${r} символов`},8708:function(t,n,e){e.d(n,{U:function(){return r}});const r=(t,n,e,r)=>{if(!1===function(t){return"object"==typeof t&&null!==t}(t))return{error:{message:`Сущность "${r}" должна быть объектом`,data:t}};const i=t,o=Object.keys(n);for(let e=0;e<o.length;e++){const s=o[e],c=n[s];if(!0===c.required&&void 0===i[s])return{error:{message:`Свойство "${s}" сущности ${r} отсутствует`,data:t}};for(let n=0;n<c.validators.length;n++){const e=c.validators[n];if(!1===e[0](i[s]))return{error:{message:e[1],data:t}}}}return{result:e(i)}}}}]);