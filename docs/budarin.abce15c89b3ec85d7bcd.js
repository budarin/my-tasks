(globalThis.webpackChunkmy_tasks=globalThis.webpackChunkmy_tasks||[]).push([[12],{2768:(t,e,r)=>{r.d(e,{X:()=>s});var n=r(2292),i=r(4874);const o=()=>{};class s{endpoint;pinoInstance;logLevel="info";constructor(t,e=void 0,r=void 0){if(this.endpoint=t,r)this.pinoInstance=r;else{const r=(0,i.pino)({formatters:{level:t=>({level:t.toUpperCase()})},browser:{serialize:!1,asObject:!1,transmit:{send:async(e,r)=>{const o=i.pino.levels.values[this.logLevel];i.pino.levels.values[e]>=o&&await fetch(`${t}/${e}`,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({id:(0,n.Z)(),method:e,params:r})})}},write:o}});this.pinoInstance=e?r.child(e):r,this.pinoInstance.level=this.logLevel}}setLevel(t){this.logLevel=t,this.pinoInstance.level=t}info(...t){this.pinoInstance.info(t)}warn(...t){this.pinoInstance.warn(t)}error(...t){this.pinoInstance.error(t)}debug(...t){this.pinoInstance.debug(t)}child(t){const e=this.pinoInstance.child(t);return new s(this.endpoint,t,e)}}},9324:(t,e,r)=>{r.d(e,{E:()=>i});const n={debug:()=>{}};class i{storeName;logger;constructor(t,e=n){this.storeName=t,this.logger=e}async setItem(t,e){const r=await globalThis.caches.open(this.storeName),n=new Response(JSON.stringify(e),{headers:{"Content-Type":"application/json; charset=utf-8"}});await r.put(t,n)}async getItem(t){const e=await globalThis.caches.open(this.storeName),r=await e.match(t);if(r){return await r.json()}return{}}async removeItem(t){const e=await globalThis.caches.open(this.storeName);return await e.delete(t)}async clear(t){return await globalThis.caches.delete(t)}}},2677:(t,e,r)=>{function n(t,e){if(t===e)return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;const r=Object.keys(t),i=Object.keys(e);return r.length===i.length&&r.every((r=>i.includes(r)&&n(t[r],e[r])))}r.d(e,{b:()=>n})},1232:(t,e,r)=>{r.d(e,{WL:()=>o});const n="x-request-id",i="application/json; charset=utf-8",o=t=>async e=>{const r=e.body.id;try{const o=await fetch(`${t}/${e.body.method}`,{...e,method:"POST",body:JSON.stringify(e.body),headers:{...e?.headers,[n]:String(r),"content-type":i,accept:i}});if(!1===o.ok)return{id:r,error:{code:o.status,message:o.statusText}};const s=await o.json();if(!function(t){if(function(t){return"id"in t&&"result"in t&&!("error"in t)}(t))return!0;if(function(t){return"id"in t&&"error"in t&&!("result"in t)}(t)){const{error:e}=t;return!("number"!=typeof e.code||"string"!=typeof e.message||"data"in e&&"object"!=typeof e.data||"stack"in e&&"string"!=typeof e.stack)}return!1}(s))throw new Error("Структура данных в ответе сервера не соответствует формату JSON-RPC");return s}catch(t){return{id:r,error:{code:-1,message:t.message,stack:t.stack}}}}},9755:(t,e,r)=>{r.d(e,{V:()=>i});const n={debug:()=>{}};class i{logger;constructor(t=n){this.logger=t}setItem(t,e){localStorage.setItem(t,encodeURIComponent(JSON.stringify(e)))}getItem(t){return JSON.parse(decodeURIComponent(localStorage.getItem(t)))}removeItem(t){localStorage.removeItem(t)}clear(){localStorage.clear()}}},3788:(t,e,r)=>{const n=()=>{};new Proxy({},{get:()=>n})},7270:(t,e,r)=>{r.d(e,{o:()=>n});const n=t=>{const e=()=>{throw new Error(t||"Попытка обратиться к неинициализированному сервису.")};return new Proxy((()=>{}),{get:e,apply:e})}},4460:(t,e,r)=>{function n(t){const{category_id:e,icon_id:r,category_name:n}=t||{};return{category_id:Number(e),icon_id:Number(r),category_name:(0,o.Z)(n.trim())}}r.d(e,{Ij:()=>g,zo:()=>p});var i=r(5681),o=r(2593),s=r(4303),a=r(140),c=r(6412),d=r(9977),u=r(8708);const l="Категория",f="Название категории",g={category_id:{title:"Идентификатор категории",name:"category_id",required:!0},icon_id:{title:"Идентификатор иконки",name:"icon_id",required:!0},category_name:{title:f,name:"category_name",type:"text",pattern:"^[a-zA-Zа-яА-Я0-9]{3}.*",spellCheck:!1,required:!0,minLength:3,maxLength:20,placeholder:f,autoComplete:"off",onInput:i.e,onInvalid:(0,i.V)(f,3,20)}},y={icon_id:{validators:[[s.F,(0,a.a)(l,"icon_id")]],required:!0},category_name:{validators:[[(0,c.y)(3,20),(0,d.P)(l,"category_name",3,20)]],required:!0}},_={category_id:{validators:[[s.F,(0,a.a)(l,"category_id")]],required:!0},...y},p=t=>(0,u.U)(t,_,n,l)},1727:(t,e,r)=>{r.d(e,{gg:()=>n.gg});var n=r(7730)},7730:(t,e,r)=>{function n(t){return e=>void 0===e||t(e)}function i(t){return"boolean"==typeof t}function o(t,e){return`Свойство сущности ${t} "${e}" должно быть undefined или boolean`}function s(t){const{task_id:e,title:r,priority_id:n,category_id:i,description:o,expire_date_time:s,deleted:a,completed:c}=t||{};return{task_id:Number(e),title:(0,_.Z)(r.trim()),priority_id:Number(n),category_id:i?Number(i):void 0,description:o,expire_date_time:s,deleted:a,completed:c}}r.d(e,{gg:()=>s,iX:()=>I});var a=r(6412),c=r(9977),d=r(4303),u=r(140),l=r(3756),f=r(9068),g=r(8708),y=r(5681),_=r(2593);const p="Задача",m=100,b="Название задачи",v=(y.e,(0,y.V)(b,3,m),{title:{validators:[[(0,a.y)(3,m),(0,c.P)(p,"title",3,m)]],required:!0},priority_id:{validators:[[d.F,(0,u.a)(p,"priority_id")]],required:!0},category_id:{validators:[[n(d.F),function(t,e){return`Свойство сущности ${t} "${e}" должно быть undefined или целым числом`}(p,"category_id")]]},expire_date_time:{validators:[[n(l.K),(0,f.m)(p,"expire_date_time")],[n((function(t){return/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?Z$/.test(t)})),`Свойство сущности ${p} "expire_date_time" должно быть датой в формате ISO`]]},deleted:{validators:[[n(i),o(p,"deleted")]]},completed:{validators:[[n(i),o(p,"completed")]]}}),h={task_id:{validators:[[d.F,(0,u.a)(p,"task_id")]],required:!0},...v},I=t=>(0,g.U)(t,h,s,p)},2593:(t,e,r)=>{function n(t){if(t)return t[0].toUpperCase()+t.slice(1).toLowerCase()}r.d(e,{Z:()=>n})},5681:(t,e,r)=>{r.d(e,{V:()=>i,e:()=>n});const n=t=>{t.currentTarget.setCustomValidity("")},i=(t,e,r)=>n=>{const i=n.currentTarget;let o=`Поле "${t}" обязательно для заполнения`;const s=i.value.replace(/\n/gm,"").trim();return i.validity.patternMismatch?(o=`Поле "${t}" должно начинаться с минимум ${e} символов, исключая спейцсимволы и пробелы`,void i.setCustomValidity(o)):s&&(s.length<e||s.length>r)?(o=`Поле "${t}" должно содержать минимум ${e} и максимум ${r} символов`,void i.setCustomValidity(o)):void i.setCustomValidity(o)}},6624:(t,e,r)=>{function n(t,e){return function(r){const n=t(r);return n.error?(i.vF.error(n.error.message,n.error.data),n):e(r)}}r.d(e,{R:()=>n});var i=r(6169)},5896:(t,e,r)=>{function n(t,e){return i.vF.error(e,t),{error:{message:e,data:t}}}r.d(e,{H:()=>n});var i=r(6169)},3702:(t,e,r)=>{r.d(e,{A:()=>d});var n=r(6169),i=r(5896),o=r(4460),s=r(924),a=r(6624),c=r(1188);const d=(0,a.R)(o.zo,(function(t){const e=n.M_.getState();if(function(t,e){return Boolean(t.categories.byId[e.category_id])}(e,t))return(0,i.H)(t,"Добавление дубликата категории");if((0,c.h)(e,t))return(0,i.H)(t,"Добавление категории с уже существующим именем категории");if((0,s.$)(e,t))return(0,i.H)(t,"Добавление категории с не существующей иконкой");const r=function(t,e){const{category_id:r}=e;return{...t,categories:{...t.categories,ids:[...t.categories.ids,r],byId:{...t.categories.byId,[r]:e}}}}(e,t);return r!==e&&n.M_.setState(r),{result:t}}))},4230:(t,e,r)=>{r.d(e,{K:()=>a});var n=r(6169),i=r(5896),o=r(4460),s=r(3402);const a=(0,r(6624).R)(o.zo,(function(t){const e=n.M_.getState();if(function(t,e){return Boolean(void 0===t.categories.byId[e.category_id])||!(0,s.x)(t.categories.byId[e.category_id],e)}(e,t))return(0,i.H)(t,"Категория не найдена");if(function(t,e){return Boolean(Object.values(t.tasks.byId).find((t=>t.category_id===e.category_id)))}(e,t))return(0,i.H)(t,"Удаление категории, которая используется");const r=function(t,e){const{category_id:r}=e,{[r]:n,...i}=t.categories.byId;return{...t,categories:{...t.categories,ids:t.categories.ids.filter((t=>t!==r)),byId:{...i}}}}(e,t);return r!==e&&n.M_.setState(r),{result:t}}))},1188:(t,e,r)=>{function n(t,e){for(const r in t.categories.byId)if(t.categories.byId[r].category_name===e.category_name&&Number(r)!==e.category_id)return!0;return!1}r.d(e,{h:()=>n})},924:(t,e,r)=>{function n(t,e){return Boolean(void 0===t.icons.byId[e.icon_id])}r.d(e,{$:()=>n})},2069:(t,e,r)=>{r.d(e,{s:()=>u});var n=r(3402),i=r(6169),o=r(5896),s=r(4460),a=r(6624),c=r(924),d=r(1188);const u=(0,a.R)(s.zo,(function(t){const e=i.M_.getState();if((0,n.x)(t,e.categories.byId[t.category_id]))return{result:t};if(function(t,e){return Boolean(void 0===t.categories.byId[e.category_id])}(e,t))return(0,o.H)(t,"Категория не найдена");if((0,c.$)(e,t))return(0,o.H)(t,"Модификация категории с не существующей иконкой");if((0,d.h)(e,t))return(0,o.H)(t,"Попытка изменить имя категории на имя уже существующей категории");const r=function(t,e){const{category_id:r}=e;return{...t,categories:{...t.categories,byId:{...t.categories.byId,[r]:e}}}}(e,t);return r!==e&&i.M_.setState(r),{result:t}}))},6539:(t,e,r)=>{function n(t){const{icon_id:e,file_name:r}=t||{};return{icon_id:Number(e),file_name:r}}r.d(e,{X:()=>g});var i=r(6169),o=r(4303),s=r(140),a=r(6412),c=r(9977),d=r(8708);const u="Иконка",l={icon_id:{validators:[[o.F,(0,s.a)(u,"icon_id")]],required:!0},file_name:{validators:[[(0,a.y)(3,20),(0,c.P)(u,"fole_name",3,20)]],required:!0}};var f=r(5896);const g=(0,r(6624).R)((t=>(0,d.U)(t,l,n,u)),(function(t){const e=i.M_.getState();if(function(t,e){return Boolean(t.icons.ids.indexOf(e.icon_id)>-1)}(e,t))return(0,f.H)(t,"Добавление дубликата идентификатора иконки");if(function(t,e){for(const r in t.icons.byId)if(t.icons.byId[r].file_name===e.file_name)return!0;return!1}(e,t))return(0,f.H)(t,"Добавление иконки с уже существующим именем файла иконки");const r=function(t,e){const{icon_id:r}=e;return{...t,icons:{...t.icons,ids:[...t.icons.ids,r],byId:{...t.icons.byId,[r]:e}}}}(e,t);return r!==e&&i.M_.setState(r),{result:t}}))},6169:(t,e,r)=>{function n(t,e){s=t,a=e}r.d(e,{B5:()=>o,M_:()=>s,Uz:()=>n,vF:()=>a});var i=r(7270);const o={icons:{byId:{},ids:[]},priorities:{byId:{},ids:[]},categories:{byId:{},ids:[]},tasks:{byId:{},ids:[]}};let s=(0,i.o)("Попытка использовать TasksStore до его инициализации!"),a=(0,i.o)("Попытка использовать logger в TasksStore до его инициализации!")},4248:(t,e,r)=>{function n(t){const{priority_id:e,priority_name:r}=t||{};return{priority_id:Number(e),priority_name:r}}r.d(e,{m:()=>f});var i=r(6169),o=r(5896),s=r(4303),a=r(140),c=r(8708);const d=["низкий","нормальный","повышенный","высокий"],u="Приоритет",l={priority_id:{validators:[[s.F,(0,a.a)(u,"priority_id")]],required:!0},priority_name:{validators:[[t=>d.includes(t),`Свойство сущности ${u} "priority_name" должно быть одним из ${JSON.stringify(d)}`]],required:!0}};const f=(0,r(6624).R)((t=>(0,c.U)(t,l,n,u)),(function(t){const e=i.M_.getState();if(function(t,e){return Boolean(t.priorities.ids.indexOf(e.priority_id)>-1)}(e,t))return(0,o.H)(t,"Добавление дубликата приоритета");if(function(t,e){for(const r in t.priorities.byId)if(t.priorities.byId[r].priority_name===e.priority_name)return!0;return!1}(e,t))return(0,o.H)(t,"Добавление приоритета с уже существующим именем");const r=function(t,e){const{priority_id:r}=e;return{...t,priorities:{...t.priorities,ids:[...t.priorities.ids,r],byId:{...t.priorities.byId,[r]:e}}}}(e,t);return r!==e&&i.M_.setState(r),{result:t}}))},8787:(t,e,r)=>{r.d(e,{X:()=>d});var n=r(6169),i=r(7730),o=r(5896),s=r(1529),a=r(565),c=r(9756);const d=(0,r(6624).R)(i.iX,(function(t){const e=n.M_.getState();if(function(t,e){return Boolean(t.tasks.byId[e.task_id])}(e,t))return(0,o.H)(t,"Добавление дубликата задачи");if((0,s.S)(e,t))return(0,o.H)(t,"Добавление задачи с не существующим приоритетом");if((0,a.E)(e,t))return(0,o.H)(t,"Добавление задачи с не существующей категорией");const r=function(t,e){const{tasks:r}=t,{task_id:n}=e,i=(0,c.z)(e);return{...t,tasks:{...r,ids:[...r.ids,n],byId:{...r.byId,[n]:i}}}}(e,t);return r!==e&&n.M_.setState(r),{result:t}}))},143:(t,e,r)=>{r.d(e,{v:()=>a});var n=r(6169),i=r(7730),o=r(5896),s=r(3402);const a=(0,r(6624).R)(i.iX,(function(t){const e=n.M_.getState();if(function(t,e){return void 0===t.tasks.byId[e.task_id]||!(0,s.x)(t.tasks.byId[e.task_id],e)}(e,t))return(0,o.H)(t,"Задача не найдена");const r=function(t,e){const{tasks:r}=t,{task_id:n}=e,i=r.ids.filter((t=>t!==n)),{[n]:o,...s}=r.byId;return{...t,tasks:{...r,ids:[...i],byId:{...s}}}}(e,t);return r!==e&&n.M_.setState(r),{result:t}}))},9756:(t,e,r)=>{function n(t){const{task_id:e,title:r,priority_id:n,category_id:i,description:o,expire_date_time:s,deleted:a,completed:c}=t;if(s){const e=Date.parse(s),r=new Date(e);r.setHours(0,0,0,0);const n=r.getTime();return{...t,expire_date_time:s,expire_date_ts:n,expire_date_time_ts:e}}return{task_id:e,title:r,priority_id:n,category_id:i,description:o,deleted:a,completed:c,expire_date_time:void 0,expire_date_ts:void 0,expire_date_time_ts:void 0}}r.d(e,{z:()=>n})},565:(t,e,r)=>{function n(t,e){return Boolean(void 0!==e.category_id&&void 0===t.categories.byId[e.category_id])}r.d(e,{E:()=>n})},1529:(t,e,r)=>{function n(t,e){return Boolean(void 0===t.priorities.byId[e.priority_id])}r.d(e,{S:()=>n})},9046:(t,e,r)=>{r.d(e,{l:()=>u});var n=r(6169),i=r(7730),o=r(5896),s=r(1529),a=r(565),c=r(6624),d=r(9756);const u=(0,c.R)(i.iX,(function(t){const e=n.M_.getState();if(function(t,e){return void 0===t.tasks.byId[e.task_id]}(e,t))return(0,o.H)(t,"Задача не найдена");if((0,s.S)(e,t))return(0,o.H)(t,"Обновление задачи с не существующим приоритетом");if((0,a.E)(e,t))return(0,o.H)(t,"Обновление задачи с не существующей категорией");const r=function(t,e){const{tasks:r}=t,{task_id:n}=e;return{...t,tasks:{...r,byId:{...r.byId,[n]:(0,d.z)(e)}}}}(e,t);return r!==e&&n.M_.setState(r),{result:t}}))},2292:(t,e,r)=>{function n(t=Date.now()){const e=new Uint8Array(10);!function(t){if(void 0!==globalThis.crypto&&"function"==typeof globalThis.crypto.getRandomValues)return globalThis.crypto.getRandomValues(t);if("function"==typeof require){const e=require("crypto").randomBytes(t.length);return t.set(e),t}throw new Error("Secure random number generation is not supported in this environment.")}(e);const r=t.toString(16).padStart(12,"0"),n=function(t){let e="";for(let r=0;r<t.length;r++){const n=t[r].toString(16);e+=2===n.length?n:"0"+n}return e}(e);return`${r.substring(0,8)}-${r.substring(8)}-${n.substring(0,4)}-${n.substring(4,8)}-${n.substring(8)}`}r.d(e,{Z:()=>n})},4303:(t,e,r)=>{function n(t){const e=Number(t);return"number"==typeof e&&Number.isInteger(e)}r.d(e,{F:()=>n})},3756:(t,e,r)=>{function n(t){return"string"==typeof t}r.d(e,{K:()=>n})},7128:(t,e,r)=>{function n(t){return e=>{if("string"!=typeof e)return!1;const r=e.trim();return t.includes(r)}}r.d(e,{Y:()=>n})},6412:(t,e,r)=>{function n(t,e=65536){return r=>{if("string"!=typeof r)return!1;const n=String(r).trim();return n.length>=t&&n.length<=e}}r.d(e,{y:()=>n})},140:(t,e,r)=>{r.d(e,{a:()=>n});const n=(t,e)=>`Свойство сущности ${t} "${e}" должно быть целым числом`},3640:(t,e,r)=>{function n(t,e){return`Свойство сущности ${t} "${e}" должно быть значением из списка`}r.d(e,{C:()=>n})},9068:(t,e,r)=>{function n(t,e){return`Свойство сущности ${t} "${e}" должно быть строкой`}r.d(e,{m:()=>n})},9977:(t,e,r)=>{r.d(e,{P:()=>n});const n=(t,e,r,n)=>`Свойство сущности ${t} "${e}" должно быть строкой длиной от ${r} до ${n} символов`},8708:(t,e,r)=>{r.d(e,{U:()=>n});const n=(t,e,r,n)=>{const i={error:{message:`Сущность "${n}" должна быть объектом`,data:t}};if(void 0===t)return i;if(!1===function(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}(t))return i;const o=t,s=Object.keys(e);for(let t=0;t<s.length;t++){const r=s[t],i=e[r];if(!0===i.required&&void 0===o[r])return{error:{message:`Свойство "${r}" сущности ${n} отсутствует`,data:o}};for(let t=0;t<i.validators.length;t++){const e=i.validators[t];if(!1===e[0](o[r]))return{error:{message:e[1],data:o}}}}return{result:r(o)}}}}]);