(globalThis.webpackChunkmy_tasks=globalThis.webpackChunkmy_tasks||[]).push([[12],{2768:(t,e,r)=>{r.d(e,{X:()=>s});var i=r(2292),n=r(4874);const o=()=>{};class s{endpoint;pinoInstance;logLevel="info";constructor(t,e=void 0,r=void 0){if(this.endpoint=t,r)this.pinoInstance=r;else{const r=(0,n.pino)({formatters:{level:t=>({level:t.toUpperCase()})},browser:{serialize:!1,asObject:!1,transmit:{send:async(e,r)=>{const o=n.pino.levels.values[this.logLevel];n.pino.levels.values[e]>=o&&await fetch(`${t}/${e}`,{method:"POST",headers:{"Content-Type":"application/json; charset=utf-8"},body:JSON.stringify({id:(0,i.Z)(),method:e,params:r})})}},write:o}});this.pinoInstance=e?r.child(e):r,this.pinoInstance.level=this.logLevel}}setLevel(t){this.logLevel=t,this.pinoInstance.level=t}info(...t){this.pinoInstance.info(t)}warn(...t){this.pinoInstance.warn(t)}error(...t){this.pinoInstance.error(t)}debug(...t){this.pinoInstance.debug(t)}child(t){const e=this.pinoInstance.child(t);return new s(this.endpoint,t,e)}}},9324:(t,e,r)=>{r.d(e,{E:()=>n});const i={debug:()=>{}};class n{storeName;logger;constructor(t,e=i){this.storeName=t,this.logger=e}async setItem(t,e){const r=await globalThis.caches.open(this.storeName),i=new Response(JSON.stringify(e),{headers:{"Content-Type":"application/json; charset=utf-8"}});await r.put(t,i)}async getItem(t){const e=await globalThis.caches.open(this.storeName),r=await e.match(t);if(r){return await r.json()}return{}}async removeItem(t){const e=await globalThis.caches.open(this.storeName);return await e.delete(t)}async clear(t){return await globalThis.caches.delete(t)}}},2677:(t,e,r)=>{function i(t,e){if(t===e)return!0;if("object"!=typeof t||null===t||"object"!=typeof e||null===e)return!1;const r=Object.keys(t),n=Object.keys(e);return r.length===n.length&&r.every((r=>n.includes(r)&&i(t[r],e[r])))}r.d(e,{b:()=>i})},1232:(t,e,r)=>{r.d(e,{WL:()=>o});const i="x-request-id",n="application/json; charset=utf-8",o=t=>async e=>{const r=e.body.id;try{const o=await fetch(`${t}/${e.body.method}`,{...e,method:"POST",body:JSON.stringify(e.body),headers:{...e?.headers,[i]:String(r),"content-type":n,accept:n}});if(!1===o.ok)return{id:r,error:{code:o.status,message:o.statusText}};const s=await o.json();if(!function(t){if(function(t){return"id"in t&&"result"in t&&!("error"in t)}(t))return!0;if(function(t){return"id"in t&&"error"in t&&!("result"in t)}(t)){const{error:e}=t;return!("number"!=typeof e.code||"string"!=typeof e.message||"data"in e&&"object"!=typeof e.data||"stack"in e&&"string"!=typeof e.stack)}return!1}(s))throw new Error("Структура данных в ответе сервера не соответствует формату JSON-RPC");return s}catch(t){return{id:r,error:{code:-1,message:t.message,stack:t.stack}}}}},9755:(t,e,r)=>{r.d(e,{V:()=>n});const i={debug:()=>{}};class n{logger;constructor(t=i){this.logger=t}setItem(t,e){localStorage.setItem(t,encodeURIComponent(JSON.stringify(e)))}getItem(t){return JSON.parse(decodeURIComponent(localStorage.getItem(t)))}removeItem(t){localStorage.removeItem(t)}clear(){localStorage.clear()}}},3788:(t,e,r)=>{const i=()=>{};new Proxy({},{get:()=>i})},7270:(t,e,r)=>{r.d(e,{o:()=>i});const i=t=>{const e=()=>{throw new Error(t||"Попытка обратиться к неинициализированному сервису.")};return new Proxy((()=>{}),{get:e,apply:e})}},4460:(t,e,r)=>{function i(t){const{category_id:e,icon_id:r,category_name:i}=t||{};return{category_id:Number(e),icon_id:Number(r),category_name:(0,o.Z)(i.trim())}}r.d(e,{Ij:()=>g,zo:()=>p});var n=r(5681),o=r(2593),s=r(4303),a=r(140),d=r(6412),c=r(9977),u=r(8708);const l="Категория",y="Название категории",g={category_id:{title:"Идентификатор категории",name:"category_id",required:!0},icon_id:{title:"Идентификатор иконки",name:"icon_id",required:!0},category_name:{title:y,name:"category_name",type:"text",pattern:"^[a-zA-Zа-яА-Я0-9]{3}.*",spellCheck:!1,required:!0,minLength:3,maxLength:20,placeholder:y,autoComplete:"off",onInput:n.e,onInvalid:(0,n.V)(y,3,20)}},f={icon_id:{validators:[[s.F,(0,a.a)(l,"icon_id")]],required:!0},category_name:{validators:[[(0,d.y)(3,20),(0,c.P)(l,"category_name",3,20)]],required:!0}},_={category_id:{validators:[[s.F,(0,a.a)(l,"category_id")]],required:!0},...f},p=t=>(0,u.U)(t,_,i,l)},1727:(t,e,r)=>{r.d(e,{gg:()=>i.gg});var i=r(7730)},7730:(t,e,r)=>{function i(t){return e=>void 0===e||t(e)}function n(t){return"boolean"==typeof t}function o(t,e){return`Свойство сущности ${t} "${e}" должно быть undefined или boolean`}function s(t){const{task_id:e,title:r,priority_id:i,category_id:n,description:o,expire_date_time:s,deleted:a,completed:d}=t||{};return{task_id:Number(e),title:(0,_.Z)(r.trim()),priority_id:Number(i),category_id:n?Number(n):void 0,description:o,expire_date_time:s,deleted:a,completed:d}}r.d(e,{gg:()=>s,tv:()=>h,iX:()=>k});var a=r(6412),d=r(9977),c=r(4303),u=r(140),l=r(3756),y=r(9068),g=r(8708),f=r(5681),_=r(2593);const p="Задача",m=100,b="Название задачи",h={task_id:{title:"Идентификатор задачи",name:"task_id",required:!0},task_date:{title:"Дата выполнения задачи",name:"task_date",type:"date"},task_time:{title:"Время выполнения задачи",name:"task_time",type:"time"},title:{title:b,name:"title",type:"text",pattern:"^[a-zA-Zа-яА-Я0-9]{3}.*",required:!0,minLength:3,maxLength:m,placeholder:b,autoComplete:"off",spellCheck:!1,onInput:f.e,onInvalid:(0,f.V)(b,3,m)},priority_id:{title:"Идентификатор приоритета",name:"priority_id",required:!0},category_id:{title:"Идентификатор категории",name:"category_id"},description:{title:"Описание задачи",name:"description",placeholder:"Подробное описание задачи",maxLength:1e3}},v={title:{validators:[[(0,a.y)(3,m),(0,d.P)(p,"title",3,m)]],required:!0},priority_id:{validators:[[c.F,(0,u.a)(p,"priority_id")]],required:!0},category_id:{validators:[[i(c.F),function(t,e){return`Свойство сущности ${t} "${e}" должно быть undefined или целым числом`}(p,"category_id")]]},expire_date_time:{validators:[[i(l.K),(0,y.m)(p,"expire_date_time")],[i((function(t){return/^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}(\.\d{3})?Z$/.test(t)})),`Свойство сущности ${p} "expire_date_time" должно быть датой в формате ISO`]]},deleted:{validators:[[i(n),o(p,"deleted")]]},completed:{validators:[[i(n),o(p,"completed")]]}},I={task_id:{validators:[[c.F,(0,u.a)(p,"task_id")]],required:!0},...v},k=t=>(0,g.U)(t,I,s,p)},2593:(t,e,r)=>{function i(t){if(t)return t[0].toUpperCase()+t.slice(1).toLowerCase()}r.d(e,{Z:()=>i})},5681:(t,e,r)=>{r.d(e,{V:()=>n,e:()=>i});const i=t=>{t.currentTarget.setCustomValidity("")},n=(t,e,r)=>i=>{const n=i.currentTarget;let o=`Поле "${t}" обязательно для заполнения`;const s=n.value.replace(/\n/gm,"").trim();return n.validity.patternMismatch?(o=`Поле "${t}" должно начинаться с минимум ${e} символов, исключая спейцсимволы и пробелы`,void n.setCustomValidity(o)):s&&(s.length<e||s.length>r)?(o=`Поле "${t}" должно содержать минимум ${e} и максимум ${r} символов`,void n.setCustomValidity(o)):void n.setCustomValidity(o)}},6624:(t,e,r)=>{function i(t,e){return function(r){const i=t(r);return i.error?(n.vF.error(i.error.message,i.error.data),i):e(r)}}r.d(e,{R:()=>i});var n=r(6169)},5896:(t,e,r)=>{function i(t,e){return n.vF.error(e,t),{error:{message:e,data:t}}}r.d(e,{H:()=>i});var n=r(6169)},3702:(t,e,r)=>{r.d(e,{A:()=>c});var i=r(6169),n=r(5896),o=r(4460),s=r(924),a=r(6624),d=r(1188);const c=(0,a.R)(o.zo,(function(t){const e=i.M_.getState();if(function(t,e){return Boolean(t.categories.byId[e.category_id])}(e,t))return(0,n.H)(t,"Добавление дубликата категории");if((0,d.h)(e,t))return(0,n.H)(t,"Добавление категории с уже существующим именем категории");if((0,s.$)(e,t))return(0,n.H)(t,"Добавление категории с не существующей иконкой");const r=function(t,e){const{category_id:r}=e;return{...t,categories:{...t.categories,ids:[...t.categories.ids,r],byId:{...t.categories.byId,[r]:e}}}}(e,t);return r!==e&&i.M_.setState(r),{result:t}}))},4230:(t,e,r)=>{r.d(e,{K:()=>a});var i=r(6169),n=r(5896),o=r(4460),s=r(3402);const a=(0,r(6624).R)(o.zo,(function(t){const e=i.M_.getState();if(function(t,e){return Boolean(void 0===t.categories.byId[e.category_id])||!(0,s.x)(t.categories.byId[e.category_id],e)}(e,t))return(0,n.H)(t,"Категория не найдена");if(function(t,e){return Boolean(Object.values(t.tasks.byId).find((t=>t.category_id===e.category_id)))}(e,t))return(0,n.H)(t,"Удаление категории, которая используется");const r=function(t,e){const{category_id:r}=e,{[r]:i,...n}=t.categories.byId;return{...t,categories:{...t.categories,ids:t.categories.ids.filter((t=>t!==r)),byId:{...n}}}}(e,t);return r!==e&&i.M_.setState(r),{result:t}}))},1188:(t,e,r)=>{function i(t,e){for(const r in t.categories.byId)if(t.categories.byId[r].category_name===e.category_name&&Number(r)!==e.category_id)return!0;return!1}r.d(e,{h:()=>i})},924:(t,e,r)=>{function i(t,e){return Boolean(void 0===t.icons.byId[e.icon_id])}r.d(e,{$:()=>i})},2069:(t,e,r)=>{r.d(e,{s:()=>u});var i=r(3402),n=r(6169),o=r(5896),s=r(4460),a=r(6624),d=r(924),c=r(1188);const u=(0,a.R)(s.zo,(function(t){const e=n.M_.getState();if((0,i.x)(t,e.categories.byId[t.category_id]))return{result:t};if(function(t,e){return Boolean(void 0===t.categories.byId[e.category_id])}(e,t))return(0,o.H)(t,"Категория не найдена");if((0,d.$)(e,t))return(0,o.H)(t,"Модификация категории с не существующей иконкой");if((0,c.h)(e,t))return(0,o.H)(t,"Попытка изменить имя категории на имя уже существующей категории");const r=function(t,e){const{category_id:r}=e;return{...t,categories:{...t.categories,byId:{...t.categories.byId,[r]:e}}}}(e,t);return r!==e&&n.M_.setState(r),{result:t}}))},6539:(t,e,r)=>{function i(t){const{icon_id:e,file_name:r}=t||{};return{icon_id:Number(e),file_name:r}}r.d(e,{X:()=>g});var n=r(6169),o=r(4303),s=r(140),a=r(6412),d=r(9977),c=r(8708);const u="Иконка",l={icon_id:{validators:[[o.F,(0,s.a)(u,"icon_id")]],required:!0},file_name:{validators:[[(0,a.y)(3,20),(0,d.P)(u,"fole_name",3,20)]],required:!0}};var y=r(5896);const g=(0,r(6624).R)((t=>(0,c.U)(t,l,i,u)),(function(t){const e=n.M_.getState();if(function(t,e){return Boolean(t.icons.ids.indexOf(e.icon_id)>-1)}(e,t))return(0,y.H)(t,"Добавление дубликата идентификатора иконки");if(function(t,e){for(const r in t.icons.byId)if(t.icons.byId[r].file_name===e.file_name)return!0;return!1}(e,t))return(0,y.H)(t,"Добавление иконки с уже существующим именем файла иконки");const r=function(t,e){const{icon_id:r}=e;return{...t,icons:{...t.icons,ids:[...t.icons.ids,r],byId:{...t.icons.byId,[r]:e}}}}(e,t);return r!==e&&n.M_.setState(r),{result:t}}))},6169:(t,e,r)=>{function i(t,e){s=t,a=e}r.d(e,{B5:()=>o,M_:()=>s,Uz:()=>i,vF:()=>a});var n=r(7270);const o={icons:{byId:{},ids:[]},priorities:{byId:{},ids:[]},categories:{byId:{},ids:[]},tasks:{byId:{},ids:[]}};let s=(0,n.o)("Попытка использовать TasksStore до его инициализации!"),a=(0,n.o)("Попытка использовать logger в TasksStore до его инициализации!")},4248:(t,e,r)=>{function i(t){const{priority_id:e,priority_name:r}=t||{};return{priority_id:Number(e),priority_name:r}}r.d(e,{m:()=>y});var n=r(6169),o=r(5896),s=r(4303),a=r(140),d=r(8708);const c=["низкий","нормальный","повышенный","высокий"],u="Приоритет",l={priority_id:{validators:[[s.F,(0,a.a)(u,"priority_id")]],required:!0},priority_name:{validators:[[t=>c.includes(t),`Свойство сущности ${u} "priority_name" должно быть одним из ${JSON.stringify(c)}`]],required:!0}};const y=(0,r(6624).R)((t=>(0,d.U)(t,l,i,u)),(function(t){const e=n.M_.getState();if(function(t,e){return Boolean(t.priorities.ids.indexOf(e.priority_id)>-1)}(e,t))return(0,o.H)(t,"Добавление дубликата приоритета");if(function(t,e){for(const r in t.priorities.byId)if(t.priorities.byId[r].priority_name===e.priority_name)return!0;return!1}(e,t))return(0,o.H)(t,"Добавление приоритета с уже существующим именем");const r=function(t,e){const{priority_id:r}=e;return{...t,priorities:{...t.priorities,ids:[...t.priorities.ids,r],byId:{...t.priorities.byId,[r]:e}}}}(e,t);return r!==e&&n.M_.setState(r),{result:t}}))},8787:(t,e,r)=>{r.d(e,{X:()=>c});var i=r(6169),n=r(7730),o=r(5896),s=r(1529),a=r(565),d=r(9756);const c=(0,r(6624).R)(n.iX,(function(t){const e=i.M_.getState();if(function(t,e){return Boolean(t.tasks.byId[e.task_id])}(e,t))return(0,o.H)(t,"Добавление дубликата задачи");if((0,s.S)(e,t))return(0,o.H)(t,"Добавление задачи с не существующим приоритетом");if((0,a.E)(e,t))return(0,o.H)(t,"Добавление задачи с не существующей категорией");const r=function(t,e){const{tasks:r}=t,{task_id:i}=e,n=(0,d.z)(e);return{...t,tasks:{...r,ids:[...r.ids,i],byId:{...r.byId,[i]:n}}}}(e,t);return r!==e&&i.M_.setState(r),{result:t}}))},143:(t,e,r)=>{r.d(e,{v:()=>a});var i=r(6169),n=r(7730),o=r(5896),s=r(3402);const a=(0,r(6624).R)(n.iX,(function(t){const e=i.M_.getState();if(function(t,e){return void 0===t.tasks.byId[e.task_id]||!(0,s.x)(t.tasks.byId[e.task_id],e)}(e,t))return(0,o.H)(t,"Задача не найдена");const r=function(t,e){const{tasks:r}=t,{task_id:i}=e,n=r.ids.filter((t=>t!==i)),{[i]:o,...s}=r.byId;return{...t,tasks:{...r,ids:[...n],byId:{...s}}}}(e,t);return r!==e&&i.M_.setState(r),{result:t}}))},9756:(t,e,r)=>{function i(t){const{task_id:e,title:r,priority_id:i,category_id:n,description:o,expire_date_time:s,deleted:a,completed:d}=t;if(s){const e=Date.parse(s),r=new Date(e);r.setHours(0,0,0,0);const i=r.getTime();return{...t,expire_date_time:s,expire_date_ts:i,expire_date_time_ts:e}}return{task_id:e,title:r,priority_id:i,category_id:n,description:o,deleted:a,completed:d,expire_date_time:void 0,expire_date_ts:void 0,expire_date_time_ts:void 0}}r.d(e,{z:()=>i})},565:(t,e,r)=>{function i(t,e){return Boolean(void 0!==e.category_id&&void 0===t.categories.byId[e.category_id])}r.d(e,{E:()=>i})},1529:(t,e,r)=>{function i(t,e){return Boolean(void 0===t.priorities.byId[e.priority_id])}r.d(e,{S:()=>i})},9046:(t,e,r)=>{r.d(e,{l:()=>u});var i=r(6169),n=r(7730),o=r(5896),s=r(1529),a=r(565),d=r(6624),c=r(9756);const u=(0,d.R)(n.iX,(function(t){const e=i.M_.getState();if(function(t,e){return void 0===t.tasks.byId[e.task_id]}(e,t))return(0,o.H)(t,"Задача не найдена");if((0,s.S)(e,t))return(0,o.H)(t,"Обновление задачи с не существующим приоритетом");if((0,a.E)(e,t))return(0,o.H)(t,"Обновление задачи с не существующей категорией");const r=function(t,e){const{tasks:r}=t,{task_id:i}=e;return{...t,tasks:{...r,byId:{...r.byId,[i]:(0,c.z)(e)}}}}(e,t);return r!==e&&i.M_.setState(r),{result:t}}))},2292:(t,e,r)=>{function i(t=Date.now()){const e=new Uint8Array(10);!function(t){if(void 0!==globalThis.crypto&&"function"==typeof globalThis.crypto.getRandomValues)return globalThis.crypto.getRandomValues(t);if("function"==typeof require){const e=require("crypto").randomBytes(t.length);return t.set(e),t}throw new Error("Secure random number generation is not supported in this environment.")}(e);const r=t.toString(16).padStart(12,"0"),i=function(t){let e="";for(let r=0;r<t.length;r++){const i=t[r].toString(16);e+=2===i.length?i:"0"+i}return e}(e);return`${r.substring(0,8)}-${r.substring(8)}-${i.substring(0,4)}-${i.substring(4,8)}-${i.substring(8)}`}r.d(e,{Z:()=>i})},4303:(t,e,r)=>{function i(t){const e=Number(t);return"number"==typeof e&&Number.isInteger(e)}r.d(e,{F:()=>i})},3756:(t,e,r)=>{function i(t){return"string"==typeof t}r.d(e,{K:()=>i})},7128:(t,e,r)=>{function i(t){return e=>{if("string"!=typeof e)return!1;const r=e.trim();return t.includes(r)}}r.d(e,{Y:()=>i})},6412:(t,e,r)=>{function i(t,e=65536){return r=>{if("string"!=typeof r)return!1;const i=String(r).trim();return i.length>=t&&i.length<=e}}r.d(e,{y:()=>i})},140:(t,e,r)=>{r.d(e,{a:()=>i});const i=(t,e)=>`Свойство сущности ${t} "${e}" должно быть целым числом`},3640:(t,e,r)=>{function i(t,e){return`Свойство сущности ${t} "${e}" должно быть значением из списка`}r.d(e,{C:()=>i})},9068:(t,e,r)=>{function i(t,e){return`Свойство сущности ${t} "${e}" должно быть строкой`}r.d(e,{m:()=>i})},9977:(t,e,r)=>{r.d(e,{P:()=>i});const i=(t,e,r,i)=>`Свойство сущности ${t} "${e}" должно быть строкой длиной от ${r} до ${i} символов`},8708:(t,e,r)=>{r.d(e,{U:()=>i});const i=(t,e,r,i)=>{const n={error:{message:`Сущность "${i}" должна быть объектом`,data:t}};if(void 0===t)return n;if(!1===function(t){return"object"==typeof t&&null!==t&&!Array.isArray(t)}(t))return n;const o=t,s=Object.keys(e);for(let t=0;t<s.length;t++){const r=s[t],n=e[r];if(!0===n.required&&void 0===o[r])return{error:{message:`Свойство "${r}" сущности ${i} отсутствует`,data:o}};for(let t=0;t<n.validators.length;t++){const e=n.validators[t];if(!1===e[0](o[r]))return{error:{message:e[1],data:o}}}}return{result:r(o)}}}}]);